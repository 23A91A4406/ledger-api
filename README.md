### Financial Ledger API — Double Entry Accounting System
A production-grade financial ledger API implementing double-entry bookkeeping, immutable transactions, accurate balance calculation, and safe concurrent transfers using FastAPI + PostgreSQL.
________________________________________
### Features Implemented

* Create accounts
* Credit & debit transactions
* Atomic money transfers (debit + credit)
* Immutable ledger entries
* Accurate balance computed from ledger
* Full transaction history per account
* Swagger Documentation
* PostgreSQL persistence
* SQLAlchemy session transactions
________________________________________
### Project Folder Structure

ledger-api/
├── app/
│   ├── main.py
│   ├── models.py
│   ├── db.py
│   └── ...
├── docker-compose.yml
├── requirements.txt and Screenshots
└── README.md and Dockerfile

________________________________________
### Tech Stack

• Python 3.11
• FastAPI
• SQLAlchemy
• Pydantic
• PostgreSQL
• Docker & Docker Compose
• Swagger UI (auto-generated by FastAPI)
________________________________________
### API Endpoints Overview

Method	Endpoint	Description
POST /accounts | Create a new account
GET /accounts | Get all accounts
GET /accounts/{account_id} | Get account details and current balance
POST /transactions | Create transfer, deposit, or withdrawal
GET /transactions | Get all transactions
GET /ledger/{account_id} | Get immutable ledger entries for an account
________________________________________
### How the Ledger System Works

  Double Entry Bookkeeping  
Every transaction creates ledger entries:  
• Credit transaction → credit amount  
• Debit transaction → debit amount  

  Ledger Is Immutable  
Once written, entries are never edited or deleted. The ledger acts as a permanent audit trail.  
____________________________________________
### Balance Calculation Strategy

In this implementation, account balances are maintained atomically during transactions, while the immutable ledger serves as the authoritative audit trail for balance verification.

For production systems, balances can be recalculated on-demand from ledger entries.
This implementation prioritizes transactional performance while preserving ledger correctness.
_________________________________________
### API Usage Examples 

1. Create Account
Request
POST /accounts
{
  "name": "Mona Savings",
  "balance": 1000
}

2️. Transfer Transaction
Request
POST /transactions
{
  "type": "transfer",
  "source_account_id": 1,
  "destination_account_id": 2,
  "amount": 200,
  "description": "Transfer from savings to checking"
}
 
3️. Verify Account Balances
Request
GET /accounts/1
{
  "id": 1,
  "name": "Mona Savings",
  "balance": "800.00",
  "currency": "USD"
}

4️. Ledger Entries
Request
GET /ledger/1
[
  {
    "id": 1,
    "transaction_id": 1,
    "entry_type": "debit",
    "amount": "200.00",
    "timestamp": "2025-12-14T11:58:38.531946+00:00"
  }
]

5️. Deposit & Withdrawal
Request
POST /transactions/
{
  "type": "deposit",
  "destination_account_id": 1,
  "amount": 300,
  "description": "Deposit paycheck"
}
_____________________________________________
### Diagrams

 1. High-Level Architecture
+-------------------+        +------------------------+        +---------------------+
|                   | HTTP   |                        |        |                     |
|     CLIENT        +------->+    FASTAPI ROUTES      +------->+    BUSINESS LOGIC   |
| (Swagger/Postman) |        |  (Accounts, Txns)     |         |   (Business Rules)  |
|                   |        |                        |        |                     |
+-------------------+        +-----------+------------+        +----------+----------+
                                           |                               |
                                           | SQLAlchemy ORM                |
                                           v                               v
                                +---------------------+        +----------------------+
                                | Account Model       |        | LedgerEntry Model    |
                                | Transaction Model   |        |                      |
                                +---------------------+        +----------------------+
                                            \                          /
                                             \                        /
                                              \                      /
                                               v                    v
                                         +--------------------------------+
                                         |          POSTGRESQL DB         |
                                         |Accounts | Transactions | Ledger|
                                         +--------------------------------+


 2. Data Flow (Credit / Debit)
User (Swagger / Postman)
        |
        | POST /transactions/
        v
+--------------------+
|   FastAPI Route    |
|  (main.py)         |
+--------------------+
        |
        | Validate request (Pydantic schema)
        v
+--------------------+
|  Service Logic     |
|  (SQLAlchemy DB    |
|   session)         |
+--------------------+
        |
        | Begin DB transaction
        |
        | Fetch source account (if any)
        | Fetch destination account (if any)
        |
        | Check sufficient balance
        | (for transfer / withdrawal)
        |
        | Create Transaction record
        |
        | Create Ledger Entry (DEBIT)
        | → Source account
        |
        | Create Ledger Entry (CREDIT)
        | → Destination account
        |
        | Update account balances
        |
        | Commit transaction
        v
+--------------------+
|  PostgreSQL DB     |
|--------------------|
| accounts           |
| transactions       |
| ledger_entries     |
+--------------------+
        ^
        |
        | Return response
        |
+--------------------+
|  API Response      |
|  (Transaction OK)  |
+--------------------+


 3. Double-Entry Ledger Diagram
|LedgerEntry ID |Account |Entry Type   | Amount |Transaction ID|
|----------------|---------|-----------|--------|------------|
| 1              | 1       | debit     | 200    | 1(transfer)|           
| 2              | 2       | credit    | 200    | 1(transfer)|           
| 3              | 1       | credit    | 300    | 2(deposit) |           
| 4              | 2       | debit     | 100    | 3(withdraw)|           
________________________________________
### Expected Outcomes

* Fully functional REST API
* Atomic transfers
* Immutable ledger
* Safe concurrency via SQLAlchemy database transactions
* Negative balances prevented
* Balance derived from ledger entries
* Complete history available
* Production-ready structure
________________________________________
### How to Run

1. Make sure Docker and Docker Compose are installed.
2. Clone the repository:
git clone <repo-url>
cd ledger-api
3. Start the application using Docker:
docker-compose up --build
4. Open Swagger UI:
http://localhost:8000/docs
_________________________________________
### Screenshots

1. Swagger UI
![Swagger UI](screenshots/1SwaggerUI.png)

2. Account 1 Created
![Account 1 Created](screenshots/2Acc1Created.png)

3. Account 2 Created
![Account 2 Created](screenshots/3Acc2Created.png)

4. Transfer Transaction
![Transfer Transaction](screenshots/4Transfer-Transaction.png)

5. Account 1 Balance
![Account 1 Balance](screenshots/6Acc1Balance.png)

6. Account 2 Balance
![Account 2 Balance](screenshots/7Acc2Balance.png)

7. Debit Ledger Entry
![Debit Entry](screenshots/8debitEntry.png)

8. Credit Ledger Entry
![Credit Entry](screenshots/9creditEntry.png)

9. Deposit Transaction
![Deposit](screenshots/10Deposit.png)

__________________________________________
### Conclusion

This project demonstrates:
•	Financial-grade ledger design
•	Strong transactional consistency
•	Clean and scalable architecture
•	Correct application of double-entry bookkeeping

