 Financial Ledger API — Double Entry Accounting System
A production-grade financial ledger API implementing double-entry bookkeeping, immutable transactions, accurate balance calculation, and safe concurrent transfers using FastAPI + PostgreSQL.
________________________________________
### Features Implemented
✔ Create accounts
✔ Credit & debit transactions
✔ Atomic money transfers (debit + credit)
✔ Immutable ledger entries
✔ Accurate balance computed from ledger
✔ Full transaction history per account
✔ Swagger Documentation
✔ PostgreSQL persistence
✔ SQLAlchemy session transactions
________________________________________
### Project Folder Structure
ledger-api/
├── app/
│   ├── main.py
│   ├── models.py
│   ├── db.py
│   └── ...
├── docker-compose.yml
├── requirements.txt
└── README.md

________________________________________
### Tech Stack
• Python 3.11
• FastAPI
• SQLAlchemy
• Pydantic
• PostgreSQL
• Docker & Docker Compose
• Swagger UI (auto-generated by FastAPI)
________________________________________
### API Endpoints Overview
Method	Endpoint	Description
POST	/accounts	Create a new account
GET	/accounts	Get all accounts
GET	/accounts/{account_id}	Get account details with computed balance
POST	/transactions	Create transfer,deposit,or withdrawal
GET	/transactions	Get all transactions
GET	/ledger/{account_id}	Ledger entries (immutable)
________________________________________
### How the Ledger System Works
 Double Entry Bookkeeping
Every transaction creates ledger entries:
•	Credit transaction → credit amount
•	Debit transaction → debit amount
 Ledger Is Immutable
Once written, entries are never edited or deleted
________________________________________
### API Usage Examples 

1. Create Account
Request
POST /accounts
{
  "name": "Mona Savings",
  "balance": 1000
}

2️. Transfer Transaction
Request
POST /transactions
{
  "type": "transfer",
  "source_account_id": 1,
  "destination_account_id": 2,
  "amount": 200,
  "description": "Transfer from savings to checking"
}
 
3️. Verify Account Balances
Request
GET /accounts/1
{
  "id": 1,
  "name": "Mona Savings",
  "balance": "800.00",
  "currency": "USD"
}

4️. Ledger Entries
Request
GET /ledger/1
[
  {
    "id": 1,
    "transaction_id": 1,
    "entry_type": "debit",
    "amount": "200.00",
    "timestamp": "2025-12-14T11:58:38.531946+00:00"
  }
]

5️. Deposit & Withdrawal
Request
POST /transactions/
{
  "type": "deposit",
  "destination_account_id": 1,
  "amount": 300,
  "description": "Deposit paycheck"
}
_______________________________________________


### Diagrams
 1. High-Level Architecture
+-------------------+        +------------------------+        +---------------------+
|                   | HTTP   |                        |        |                     |
|     CLIENT        +------->+    FASTAPI ROUTES      +------->+    BUSINESS LOGIC   |
| (Swagger/Postman) |        |  (Accounts, Txns)     |         |   (Business Rules)  |
|                   |        |                        |        |                     |
+-------------------+        +-----------+------------+        +----------+----------+
                                           |                               |
                                           | SQLAlchemy ORM                |
                                           v                               v
                                +---------------------+        +----------------------+
                                | Account Model       |        | LedgerEntry Model    |
                                | Transaction Model   |        |                      |
                                +---------------------+        +----------------------+
                                            \                          /
                                             \                        /
                                              \                      /
                                               v                    v
                                         +--------------------------------+
                                         |          POSTGRESQL DB         |
                                         |Accounts | Transactions | Ledger|
                                         +--------------------------------+


 2. Data Flow (Credit / Debit)
User (Swagger / Postman)
        |
        | POST /transactions/
        v
+--------------------+
|   FastAPI Route    |
|  (main.py)         |
+--------------------+
        |
        | Validate request (Pydantic schema)
        v
+--------------------+
|  Service Logic     |
|  (SQLAlchemy DB    |
|   session)         |
+--------------------+
        |
        | Begin DB transaction
        |
        | Fetch source account (if any)
        | Fetch destination account (if any)
        |
        | Check sufficient balance
        | (for transfer / withdrawal)
        |
        | Create Transaction record
        |
        | Create Ledger Entry (DEBIT)
        | → Source account
        |
        | Create Ledger Entry (CREDIT)
        | → Destination account
        |
        | Update account balances
        |
        | Commit transaction
        v
+--------------------+
|  PostgreSQL DB     |
|--------------------|
| accounts           |
| transactions       |
| ledger_entries     |
+--------------------+
        ^
        |
        | Return response
        |
+--------------------+
|  API Response      |
|  (Transaction OK)  |
+--------------------+


 3. Double-Entry Ledger Diagram
|LedgerEntry ID |Account |Entry Type   | Amount |Transaction ID|
|----------------|---------|-----------|--------|------------|
| 1              | 1       | debit     | 200    | 1(transfer)|           
| 2              | 2       | credit    | 200    | 1(transfer)|           
| 3              | 1       | credit    | 300    | 2(deposit) |           
| 4              | 2       | debit     | 100    | 3(withdraw)|           
________________________________________
### Expected Outcomes 
✔ Fully functional REST API
✔ Atomic transfers
✔ Immutable ledger
✔ Safe concurrency via SQLAlchemy database transactions
✔ Negative balances prevented
✔ Balance derived from ledger entries
✔ Complete history available
✔ Production-ready structure
________________________________________
### How to Run
1. Make sure Docker and Docker Compose are installed.
2. Clone the repository:
git clone <your-repo-url>
cd ledger-api
3. Start the application using Docker:
docker-compose up --build
4. Open Swagger UI:
http://localhost:8000/docs

### Conclusion
This project demonstrates:
•	Financial-grade ledger design
•	Strong transactional consistency
•	Clean and scalable architecture
•	Correct application of double-entry bookkeeping

